import{a as f}from"./chunk-WCF7E4PB.js";import{L as w,P as S,a as b,b as y,g as C}from"./chunk-TFJ7GAPU.js";var v=class p{constructor(e){this.supabaseService=e}get supabaseClient(){let e=this.supabaseService;return e.getClient?e.getClient():e.supabase}PREFIX="komfort_";BUCKET_NAME="product-images";CATEGORIES_BUCKET="category-images";SLIDES_BUCKET="slides";SHOPS_BUCKET="shop-images";get supabase(){return this.supabaseService.getClient?this.supabaseService.getClient():this.supabaseService.supabase||this.supabaseService.supabaseClient}save(e,t){try{let o=this.PREFIX+e;sessionStorage.setItem(o,JSON.stringify(t)),localStorage.setItem(o,JSON.stringify(t)),console.log(`\u{1F4BE} \u041B\u043E\u043A\u0430\u043B\u044C\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B: ${o}`,t)}catch(o){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0432 \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E\u0435 \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435:",o)}}load(e){try{let t=this.PREFIX+e,o=sessionStorage.getItem(t);return o||(o=localStorage.getItem(t)),o?JSON.parse(o):null}catch(t){return console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437 \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E\u0433\u043E \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0430:",t),null}}clear(){let e=[];for(let t=0;t<localStorage.length;t++){let o=localStorage.key(t);o?.startsWith(this.PREFIX)&&e.push(o)}e.forEach(t=>{localStorage.removeItem(t),sessionStorage.removeItem(t)}),console.log("\u{1F9F9} \u041B\u043E\u043A\u0430\u043B\u044C\u043D\u043E\u0435 \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u043E\u0447\u0438\u0449\u0435\u043D\u043E")}async uploadFile(e,t=this.BUCKET_NAME,o){try{if(!this.isImageFile(e))throw new Error("\u0424\u0430\u0439\u043B \u0434\u043E\u043B\u0436\u0435\u043D \u0431\u044B\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435\u043C");if(!this.validateFileSize(e,10))throw new Error("\u0420\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u0435\u043D \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 10MB");let a=e.name.split(".").pop()?.toLowerCase()||"jpg",r=this.generateUniqueFileName(a),s=o?`${o}/${r}`:r;console.log("\u{1F4E4} \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0444\u0430\u0439\u043B\u0430 \u0432 Supabase Storage:"),console.log(`   Bucket: ${t}`),console.log(`   \u041F\u0443\u0442\u044C: ${s}`),console.log(`   \u0420\u0430\u0437\u043C\u0435\u0440: ${(e.size/1024/1024).toFixed(2)} MB`),console.log(`   \u0422\u0438\u043F: ${e.type}`);let{data:i,error:n}=await this.supabase.storage.from(t).upload(s,e,{cacheControl:"3600",upsert:!1,contentType:e.type});if(n)throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0444\u0430\u0439\u043B\u0430 \u0432 Supabase:",n),n;console.log("\u2705 \u0424\u0430\u0439\u043B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D:",i);let l=this.getPublicUrl(s,t);return console.log("\u{1F517} \u041F\u0443\u0431\u043B\u0438\u0447\u043D\u044B\u0439 URL:",l),l}catch(a){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 uploadFile:",a),a}}async uploadMultipleFiles(e,t,o){console.log(`\u{1F4E4} \u041D\u0430\u0447\u0438\u043D\u0430\u044E \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443 ${e.length} \u0444\u0430\u0439\u043B\u043E\u0432...`);let a=e.map((r,s)=>(console.log(`   \u0424\u0430\u0439\u043B ${s+1}: ${r.name} (${(r.size/1024).toFixed(1)} KB)`),this.uploadFile(r,t,o)));try{let r=await Promise.all(a);return console.log(`\u2705 \u0412\u0441\u0435 \u0444\u0430\u0439\u043B\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B: ${r.length} \u0448\u0442.`),r}catch(r){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u0438\u0445 \u0444\u0430\u0439\u043B\u043E\u0432:",r),r}}getPublicUrl(e,t=this.BUCKET_NAME){try{let{data:o}=this.supabase.storage.from(t).getPublicUrl(e);return o.publicUrl}catch(o){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u043F\u0443\u0431\u043B\u0438\u0447\u043D\u043E\u0433\u043E URL:",o),o}}async deleteFile(e,t=this.BUCKET_NAME){try{console.log(`\u{1F5D1}\uFE0F \u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0444\u0430\u0439\u043B\u0430 \u0438\u0437 Supabase: ${e} (bucket: ${t})`);let{error:o}=await this.supabase.storage.from(t).remove([e]);if(o)throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u0430:",o),o;console.log("\u2705 \u0424\u0430\u0439\u043B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D")}catch(o){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 deleteFile:",o),o}}async deleteMultipleFiles(e,t){if(e.length!==0)try{console.log(`\u{1F5D1}\uFE0F \u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 ${e.length} \u0444\u0430\u0439\u043B\u043E\u0432 \u0438\u0437 Supabase...`);let{error:o}=await this.supabase.storage.from(t||this.BUCKET_NAME).remove(e);if(o)throw o;console.log("\u2705 \u0424\u0430\u0439\u043B\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u044B")}catch(o){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u0438\u0445 \u0444\u0430\u0439\u043B\u043E\u0432:",o),o}}async uploadProductImage(e){return this.uploadFile(e,this.BUCKET_NAME,"products")}async uploadCategoryImage(e){return this.uploadFile(e,this.CATEGORIES_BUCKET,"categories")}async uploadShopImage(e){return this.uploadFile(e,this.SHOPS_BUCKET,"shops")}async uploadSlideImage(e){return this.uploadFile(e,this.SLIDES_BUCKET,"slides")}isImageFile(e){return["image/jpeg","image/jpg","image/png","image/webp","image/gif","image/svg+xml"].includes(e.type.toLowerCase())}validateFileSize(e,t){let o=t*1024*1024;return e.size<=o}generateUniqueFileName(e){let t=Date.now(),o=Math.random().toString(36).substring(2,9);return`${t}_${o}.${e}`}extractFileNameFromUrl(e){try{let o=new URL(e).pathname.split("/");return o[o.length-1]}catch{return e}}extractFilePathFromUrl(e){try{let o=new URL(e).pathname,a=o.match(/\/storage\/v1\/object\/public\/[^/]+\/(.+)/);return a?a[1]:o}catch{return e}}getBucketFromUrl(e){try{let a=new URL(e).pathname.match(/\/storage\/v1\/object\/public\/([^/]+)/);return a?a[1]:this.BUCKET_NAME}catch{return this.BUCKET_NAME}}isSupabaseStorageUrl(e){return e.includes("supabase.co/storage")||e.includes("/storage/v1/object/public/")}base64ToFile(e,t){let o=e.split(","),a=o[0].match(/:(.*?);/)?.[1]||"image/jpeg",r=atob(o[1]),s=r.length,i=new Uint8Array(s);for(;s--;)i[s]=r.charCodeAt(s);return new File([i],t,{type:a})}async downloadFileFromUrl(e){try{let o=await(await fetch(e)).blob(),a=this.extractFileNameFromUrl(e)||`downloaded_${Date.now()}.jpg`;return new File([o],a,{type:o.type})}catch(t){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0444\u0430\u0439\u043B\u0430 \u043F\u043E URL:",t),t}}async createBucket(e,t=!0){try{console.log(`\u{1F6E0}\uFE0F \u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 bucket'\u0430: ${e} (public: ${t})`),console.warn("\u26A0\uFE0F Bucket'\u044B \u0441\u043E\u0437\u0434\u0430\u044E\u0442\u0441\u044F \u0447\u0435\u0440\u0435\u0437 \u043F\u0430\u043D\u0435\u043B\u044C \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0430 Supabase"),console.warn("   \u041F\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432: Supabase \u2192 Storage \u2192 Create New Bucket"),console.warn(`   \u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435: ${e}`),console.warn(`   Public: ${t?"Yes":"No"}`),await this.checkBucketExists(e)}catch(o){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0440\u0430\u0431\u043E\u0442\u044B \u0441 bucket'\u043E\u043C:",o),o}}async compressImage(e,t=1200,o=.7){return new Promise((a,r)=>{console.log(`\u{1F4D0} \u0421\u0436\u0430\u0442\u0438\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F: ${e.name} (${(e.size/1024/1024).toFixed(2)} MB)`);let s=new Image,i=new FileReader;i.onload=n=>{s.src=n.target?.result,s.onload=()=>{let l=s.width,c=s.height;l>t&&(c=c*t/l,l=t);let u=document.createElement("canvas");u.width=l,u.height=c;let g=u.getContext("2d");if(!g){r(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 canvas"));return}g.drawImage(s,0,0,l,c);let h=e.type.includes("png")?"image/png":"image/jpeg";u.toBlob(m=>{if(!m){r(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u0436\u0430\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"));return}let d=new File([m],e.name.replace(/\.[^/.]+$/,"")+".jpg",{type:h});console.log("\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0441\u0436\u0430\u0442\u043E:"),console.log(`   \u0414\u043E: ${(e.size/1024/1024).toFixed(2)} MB`),console.log(`   \u041F\u043E\u0441\u043B\u0435: ${(d.size/1024/1024).toFixed(2)} MB`),console.log(`   \u0421\u0436\u0430\u0442\u0438\u0435: ${((1-d.size/e.size)*100).toFixed(1)}%`),a(d)},h,o)},s.onerror=()=>r(new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F"))},i.onerror=()=>r(new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u0430")),i.readAsDataURL(e)})}async checkBucketExists(e){try{let{data:t,error:o}=await this.supabase.storage.from(e).list();return!(o&&o.message.includes("not found"))}catch{return!1}}async initializeBuckets(){console.log("\u{1F6E0}\uFE0F \u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F bucket'\u043E\u0432...");let e=[{name:this.BUCKET_NAME,description:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u043E\u0432"},{name:this.CATEGORIES_BUCKET,description:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439"},{name:this.SLIDES_BUCKET,description:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0441\u043B\u0430\u0439\u0434\u043E\u0432"},{name:this.SHOPS_BUCKET,description:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043C\u0430\u0433\u0430\u0437\u0438\u043D\u043E\u0432"}];for(let t of e)try{await this.checkBucketExists(t.name)?console.log(`\u2705 Bucket "${t.name}" \u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D`):(console.warn(`\u26A0\uFE0F Bucket "${t.name}" \u043D\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!`),console.warn("   \u0421\u043E\u0437\u0434\u0430\u0439\u0442\u0435 \u0435\u0433\u043E \u0432 \u043F\u0430\u043D\u0435\u043B\u0438 Supabase: Storage \u2192 New Bucket"),console.warn(`   \u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435: ${t.name}`),console.warn("   Public: Yes"),console.warn(`   \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435: ${t.description}`))}catch(o){console.error(`\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u043E\u0432\u0435\u0440\u043A\u0438 bucket'\u0430 "${t.name}":`,o)}}async getStorageInfo(){try{console.log("\u{1F4CA} \u041F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0435 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E Storage...");let e=[this.BUCKET_NAME,this.CATEGORIES_BUCKET,this.SLIDES_BUCKET,this.SHOPS_BUCKET],t=[],o=0,a=0;for(let r of e)try{let{data:s,error:i}=await this.supabase.storage.from(r).list();if(i){console.warn(`\u26A0\uFE0F \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u043E\u0432 \u0438\u0437 bucket'\u0430 ${r}:`,i.message);continue}if(s){let n=s.length,l=s.reduce((c,u)=>c+(u.metadata?.size||0),0);t.push({name:r,fileCount:n,size:l}),o+=n,a+=l}}catch(s){console.warn(`\u26A0\uFE0F \u041F\u0440\u043E\u043F\u0443\u0441\u043A\u0430\u0435\u043C bucket ${r}:`,s)}return{totalFiles:o,totalSize:a,buckets:t}}catch(e){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E Storage:",e),e}}async uploadFileWithCompression(e,t=this.BUCKET_NAME,o,a=1200,r=.7){try{console.log(`\u{1F4E4} \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441 \u0441\u0436\u0430\u0442\u0438\u0435\u043C: ${e.name}`);let s=await this.compressImage(e,a,r);return await this.uploadFile(s,t,o)}catch(s){return console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0436\u0430\u0442\u0438\u044F, \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u043E\u0440\u0438\u0433\u0438\u043D\u0430\u043B:",s),await this.uploadFile(e,t,o)}}async logStorageInfo(){try{let e=await this.getStorageInfo();console.log("\u{1F4CA} =========== \u0418\u041D\u0424\u041E\u0420\u041C\u0410\u0426\u0418\u042F \u041E STORAGE ==========="),console.log(`\u{1F4C1} \u0412\u0441\u0435\u0433\u043E \u0444\u0430\u0439\u043B\u043E\u0432: ${e.totalFiles}`),console.log(`\u{1F4BE} \u041E\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043C\u0435\u0440: ${(e.totalSize/1024/1024).toFixed(2)} MB`),console.log(""),e.buckets.forEach(t=>{console.log(`\u{1FAA3} ${t.name}:`),console.log(`   \u{1F4C4} \u0424\u0430\u0439\u043B\u043E\u0432: ${t.fileCount}`),console.log(`   \u{1F4BE} \u0420\u0430\u0437\u043C\u0435\u0440: ${(t.size/1024/1024).toFixed(2)} MB`)}),console.log("=============================================")}catch(e){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043B\u043E\u0433\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E Storage:",e)}}static \u0275fac=function(t){return new(t||p)(S(f))};static \u0275prov=w({token:p,factory:p.\u0275fac,providedIn:"root"})};var $=class p{constructor(e,t){this.supabaseService=e;this.storageService=t;this.initialize()}categoriesSubject=new C([]);loadingSubject=new C(!1);errorSubject=new C(null);categories$=this.categoriesSubject.asObservable();loading$=this.loadingSubject.asObservable();error$=this.errorSubject.asObservable();storageMode="supabase";storageKey="komfort_categories";categoriesCache=null;cacheTimestamp=0;CACHE_DURATION=300*1e3;isInitialized=!1;isInitializing=!1;async initialize(){if(!(this.isInitialized||this.isInitializing)){this.isInitializing=!0;try{let e=localStorage.getItem("komfort_storage_mode");this.storageMode=e==="local"||e==="supabase"?e:"supabase",console.log("=== CatalogService \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D ==="),console.log("\u0420\u0435\u0436\u0438\u043C \u0440\u0430\u0431\u043E\u0442\u044B:",this.storageMode),await this.loadCategories(),console.log("\u2705 \u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439:",this.categoriesSubject.getValue().length)}catch(e){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438 CatalogService:",e),this.errorSubject.next("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439")}finally{this.isInitializing=!1,this.isInitialized=!0}}}getInitialCategories(){return[{id:1,title:"\u0413\u043E\u0441\u0442\u0438\u043D\u0430\u044F",image:"assets/livingroom.jpg",slug:"gostinaya",description:"\u041C\u0435\u0431\u0435\u043B\u044C \u0434\u043B\u044F \u0433\u043E\u0441\u0442\u0438\u043D\u043E\u0439",order:1,isActive:!0,createdAt:new Date},{id:2,title:"\u0421\u043F\u0430\u043B\u044C\u043D\u044F",image:"assets/bedroom.jpg",slug:"spalnya",description:"\u041C\u0435\u0431\u0435\u043B\u044C \u0434\u043B\u044F \u0441\u043F\u0430\u043B\u044C\u043D\u0438",order:2,isActive:!0,createdAt:new Date},{id:3,title:"\u041A\u0443\u0445\u043D\u044F",image:"assets/kitchen.jpg",slug:"kuhnya",description:"\u041C\u0435\u0431\u0435\u043B\u044C \u0434\u043B\u044F \u043A\u0443\u0445\u043D\u0438",order:3,isActive:!0,createdAt:new Date}]}async loadCategories(){this.loadingSubject.next(!0),this.errorSubject.next(null);try{this.storageMode==="local"?await this.loadFromLocalStorage():await this.loadFromSupabase(),this.categoriesSubject.getValue().length===0&&this.storageMode==="local"&&(console.log("\u{1F4ED} \u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445, \u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0435\u043C \u043D\u0430\u0447\u0430\u043B\u044C\u043D\u044B\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438"),this.categoriesSubject.next(this.getInitialCategories()))}catch(e){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439:",e),this.errorSubject.next("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438"),e}finally{this.loadingSubject.next(!1)}}async loadFromLocalStorage(){console.log("\u{1F4BE} \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439 \u0438\u0437 localStorage...");try{let e=localStorage.getItem(this.storageKey);if(e){let t=JSON.parse(e);console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B \u0438\u0437 localStorage:",t.length),this.categoriesSubject.next(t),this.categoriesCache=t}else console.log("\u{1F4ED} \u041D\u0435\u0442 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u044B\u0445 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439 \u0432 localStorage")}catch(e){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437 localStorage:",e),e}}async loadFromSupabase(){let e=Date.now()-this.cacheTimestamp;if(this.categoriesCache&&e<this.CACHE_DURATION){console.log(`\u{1F4BE} \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u043A\u044D\u0448 (\u0432\u043E\u0437\u0440\u0430\u0441\u0442: ${Math.round(e/1e3)} \u0441\u0435\u043A)`),this.categoriesSubject.next(this.categoriesCache);return}console.log("\u23F1\uFE0F [\u041D\u0410\u0427\u0410\u041B\u041E] \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439 \u0438\u0437 Supabase...");let t=performance.now();try{let{data:o,error:a}=await this.supabaseService.getClient().from("categories").select("*").eq("is_active",!0).order("order",{ascending:!0}).limit(50),r=performance.now()-t;if(a)throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u043A Supabase:",a),a;if(console.log(`\u23F1\uFE0F [\u0417\u0410\u041F\u0420\u041E\u0421] \u0412\u0440\u0435\u043C\u044F \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F: ${r.toFixed(0)}ms`),console.log(`\u{1F4CA} \u041F\u043E\u043B\u0443\u0447\u0435\u043D\u043E \u0437\u0430\u043F\u0438\u0441\u0435\u0439: ${o?.length||0}`),o&&o.length>0){let s=performance.now(),i=o.map(c=>({id:c.id,title:c.title,image:this.normalizeImageUrl(c.image),slug:c.slug,description:c.description||"",order:c.order||0,isActive:c.is_active!==!1,createdAt:c.created_at?new Date(c.created_at):new Date})),n=performance.now()-s,l=performance.now()-t;console.log(`\u23F1\uFE0F [\u041E\u0411\u0420\u0410\u0411\u041E\u0422\u041A\u0410] \u0412\u0440\u0435\u043C\u044F: ${n.toFixed(0)}ms`),console.log(`\u23F1\uFE0F [\u041E\u0411\u0429\u0415\u0415] \u0412\u0440\u0435\u043C\u044F: ${l.toFixed(0)}ms`),this.categoriesCache=i,this.cacheTimestamp=Date.now(),this.categoriesSubject.next(i),this.saveToLocalStorage(i),console.log(`\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B \u0438\u0437 Supabase: ${i.length}`),i.slice(0,3).forEach((c,u)=>{console.log(`  ${u+1}. ${c.title} (ID: ${c.id})`)})}else console.log("\u{1F4ED} \u0412 Supabase \u043D\u0435\u0442 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439")}catch(o){throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437 Supabase:",o),this.categoriesCache&&(console.log("\u{1F504} \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u0439 \u043A\u044D\u0448 \u0438\u0437-\u0437\u0430 \u043E\u0448\u0438\u0431\u043A\u0438"),this.categoriesSubject.next(this.categoriesCache)),o}}normalizeImageUrl(e){return e?e.includes("supabase.co")||e.startsWith("/assets/")?e:e.startsWith("assets/")?"/"+e:e.startsWith("data:image")?(console.warn("\u26A0\uFE0F \u041E\u0431\u043D\u0430\u0440\u0443\u0436\u0435\u043D\u043E Base64 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435, \u0437\u0430\u043C\u0435\u043D\u044F\u0435\u043C \u043D\u0430 \u0434\u0435\u0444\u043E\u043B\u0442\u043D\u043E\u0435"),"/assets/default-category.jpg"):e:"/assets/default-category.jpg"}saveToLocalStorage(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e)),console.log("\u{1F4BE} \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B \u0432 localStorage (\u043A\u044D\u0448):",e.length)}catch(t){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0432 localStorage:",t)}}async compressImage(e,t=1200,o=.8,a="image/jpeg"){return new Promise((r,s)=>{console.log(`\u{1F4CA} \u041D\u0430\u0447\u0438\u043D\u0430\u0435\u043C \u0441\u0436\u0430\u0442\u0438\u0435: ${e.name} (${(e.size/1024).toFixed(1)} KB)`);let i=new FileReader,n=new Image,l=document.createElement("canvas"),c=l.getContext("2d");if(!c){s(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 canvas"));return}i.onload=u=>{n.onload=()=>{try{let g=n.width,h=n.height;if(console.log(`\u{1F4CF} \u0418\u0441\u0445\u043E\u0434\u043D\u044B\u0435 \u0440\u0430\u0437\u043C\u0435\u0440\u044B: ${g}x${h}`),g>t){let m=t/g;h=Math.round(h*m),g=t,console.log(`\u{1F4D0} \u041D\u043E\u0432\u044B\u0435 \u0440\u0430\u0437\u043C\u0435\u0440\u044B: ${g}x${h}`)}l.width=g,l.height=h,c.drawImage(n,0,0,g,h),l.toBlob(m=>{if(m){let d=a==="image/png"?"png":"jpg",I=e.name.replace(/\.[^/.]+$/,"")+`_compressed.${d}`,F=new File([m],I,{type:a,lastModified:Date.now()});console.log("\u2705 \u0421\u0436\u0430\u0442\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E:"),console.log(`   \u041E\u0440\u0438\u0433\u0438\u043D\u0430\u043B: ${(e.size/1024).toFixed(1)} KB`),console.log(`   \u041F\u043E\u0441\u043B\u0435 \u0441\u0436\u0430\u0442\u0438\u044F: ${(F.size/1024).toFixed(1)} KB`),console.log(`   \u042D\u043A\u043E\u043D\u043E\u043C\u0438\u044F: ${((1-F.size/e.size)*100).toFixed(1)}%`),r(F)}else s(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u0436\u0430\u0442\u043E\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"))},a,o)}catch(g){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u0436\u0430\u0442\u0438\u0438:",g),s(g)}},n.onerror=()=>{s(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0434\u043B\u044F \u0441\u0436\u0430\u0442\u0438\u044F"))},n.src=u.target.result},i.onerror=()=>{s(new Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u0440\u043E\u0447\u0438\u0442\u0430\u0442\u044C \u0444\u0430\u0439\u043B"))},i.readAsDataURL(e)})}getCompressionSettings(e){let t=e.type==="image/png";return{maxWidth:e.size>2*1024*1024?1e3:1200,quality:t?.9:.85,format:t?"image/png":"image/jpeg"}}async uploadCategoryImage(e){try{console.log("\u{1F4E4} \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438...");let t=this.getCompressionSettings(e);console.log("\u{1F39B}\uFE0F \u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0441\u0436\u0430\u0442\u0438\u044F:",t);let o=await this.compressImage(e,t.maxWidth,t.quality,t.format),a=Date.now(),r=Math.random().toString(36).substring(2,8),s=o.type==="image/png"?"png":"jpg",i=`${a}_${r}.${s}`,n=`categories/${i}`,l=this.supabaseService.getClient();console.log(`\u{1F4C1} \u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0441\u0436\u0430\u0442\u044B\u0439 \u0444\u0430\u0439\u043B: ${i}`);let{data:c,error:u}=await l.storage.from("category-images").upload(n,o,{cacheControl:"86400",upsert:!1,contentType:o.type});if(u)throw console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0432 Supabase:",u),u;let{data:g}=l.storage.from("category-images").getPublicUrl(n);return console.log("\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E:",g.publicUrl),g.publicUrl}catch(t){if(console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438:",t),t.message.includes("\u0441\u0436\u0430\u0442\u0438\u0435")||t.message.includes("canvas"))return console.log("\u{1F504} Fallback: \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0431\u0435\u0437 \u0441\u0436\u0430\u0442\u0438\u044F..."),await this.uploadImageWithoutCompression(e);throw t}}async uploadImageWithoutCompression(e){console.warn("\u26A0\uFE0F \u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0431\u0435\u0437 \u0441\u0436\u0430\u0442\u0438\u044F (fallback)");let t=Date.now(),o=Math.random().toString(36).substring(2,8),a=e.name.split(".").pop()?.toLowerCase()||"jpg",s=`categories/${`${t}_${o}.${a}`}`,i=this.supabaseService.getClient(),{data:n,error:l}=await i.storage.from("category-images").upload(s,e,{cacheControl:"86400",upsert:!1,contentType:e.type});if(l)throw l;let{data:c}=i.storage.from("category-images").getPublicUrl(s);return c.publicUrl}createOptimizedImageUrl(e,t=800){return e.includes("supabase.co")?`${e.split("?")[0]}?width=${t}&quality=85&format=auto`:e}async updateCategory(e,t){console.log("\u270F\uFE0F \u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 ID:",e);let o=this.categoriesSubject.getValue(),a=o.findIndex(i=>i.id===e);if(a===-1)return console.error(`\u274C \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0441 id ${e} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430`),this.errorSubject.next(`\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0441 id ${e} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430`),null;let r=y(b(b({},o[a]),t),{updatedAt:new Date}),s=[...o];if(s[a]=r,this.categoriesSubject.next(s),this.categoriesCache=s,this.saveToLocalStorage(s),this.storageMode==="supabase")try{let i={title:r.title,slug:r.slug,image:r.image,description:r.description,order:r.order,is_active:r.isActive,updated_at:new Date().toISOString()};await this.supabaseService.updateCategory(e,i)?console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0441\u0438\u043D\u0445\u0440\u043E\u043D\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u0430 \u0441 Supabase"):console.warn("\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u0438\u043D\u0445\u0440\u043E\u043D\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441 Supabase")}catch(i){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0438\u043D\u0445\u0440\u043E\u043D\u0438\u0437\u0430\u0446\u0438\u0438 \u0441 Supabase:",i)}return console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430:",r.title),r}async addCategory(e){console.log("\u2795 \u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438:",e.title);let t=y(b({},e),{id:this.generateId(),createdAt:new Date}),o=[...this.categoriesSubject.getValue(),t];if(this.categoriesSubject.next(o),this.categoriesCache=o,this.saveToLocalStorage(o),this.storageMode==="supabase")try{let a={title:t.title,slug:t.slug,image:t.image,description:t.description,order:t.order,is_active:t.isActive,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},r=await this.supabaseService.addCategory(a);if(r){let s=y(b({},t),{id:r.id}),i=o.map(n=>n.id===t.id?s:n);return this.categoriesSubject.next(i),this.categoriesCache=i,this.saveToLocalStorage(i),console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430 \u0432 Supabase:",r.title),s}}catch(a){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0432 Supabase:",a)}return console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430 \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E:",t.title),t}async deleteCategory(e){console.log("\u{1F5D1}\uFE0F \u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 ID:",e);let t=this.categoriesSubject.getValue(),o=this.getCategoryById(e);if(!o)return console.error(`\u274C \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0441 id ${e} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430`),this.errorSubject.next(`\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0441 id ${e} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430`),!1;if(this.storageMode==="supabase"&&o.image.includes("supabase.co")&&o.image.includes("/storage/v1/object/public/"))try{await this.deleteCategoryImageFromStorage(o.image),console.log("\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u043E \u0438\u0437 Storage")}catch(r){console.warn("\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0438\u0437 Storage:",r)}let a=t.filter(r=>r.id!==e);if(this.categoriesSubject.next(a),this.categoriesCache=a,this.saveToLocalStorage(a),this.storageMode==="supabase")try{return await this.supabaseService.deleteCategory(e)?(console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u0430 \u0438\u0437 Supabase"),!0):(console.warn("\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0438\u0437 Supabase"),!1)}catch(r){return console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0438\u0437 Supabase:",r),!1}return console.log("\u2705 \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u0430 \u043B\u043E\u043A\u0430\u043B\u044C\u043D\u043E"),!0}async deleteCategoryImageFromStorage(e){try{let t=this.extractFilePathFromUrl(e);if(!t){console.log("\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0438\u0437\u0432\u043B\u0435\u0447\u044C \u043F\u0443\u0442\u044C \u0444\u0430\u0439\u043B\u0430 \u0438\u0437 URL:",e);return}console.log(`\u{1F5D1}\uFE0F \u0423\u0434\u0430\u043B\u044F\u0435\u043C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0438\u0437 Storage: ${t}`);let o=this.supabaseService.getClient(),{error:a}=await o.storage.from("category-images").remove([t]);a?console.warn("\u26A0\uFE0F \u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438:",a):console.log("\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u043E \u0438\u0437 Storage")}catch(t){console.error("\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438:",t)}}extractFilePathFromUrl(e){if(!e.includes("supabase.co")||!e.includes("/storage/v1/object/public/"))return null;try{let o=new URL(e).pathname.split("/"),a=o.indexOf("public");if(a!==-1&&a+1<o.length)return o.slice(a+1).join("/")}catch{console.warn("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0440\u0430\u0441\u043F\u0430\u0440\u0441\u0438\u0442\u044C URL:",e)}return null}generateId(){let e=this.categoriesSubject.getValue();return e.length===0?1:Math.max(...e.map(o=>o.id))+1}getCategories(){return this.categoriesSubject.getValue()}getCategoryById(e){return this.categoriesSubject.getValue().find(t=>t.id===e)}getCategoryBySlug(e){return this.categoriesSubject.getValue().find(t=>t.slug===e)}getStorageMode(){return this.storageMode}async switchStorageMode(e){this.storageMode!==e&&(console.log(`\u{1F504} \u041F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u0440\u0435\u0436\u0438\u043C\u0430 \u0441 ${this.storageMode} \u043D\u0430 ${e}`),this.storageMode=e,localStorage.setItem("komfort_storage_mode",e),this.categoriesCache=null,this.cacheTimestamp=0,await this.loadCategories())}async forceReload(){console.log("\u{1F504} \u041F\u0440\u0438\u043D\u0443\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439..."),this.categoriesCache=null,this.cacheTimestamp=0,await this.loadCategories()}clearCache(){console.log("\u{1F5D1}\uFE0F \u041E\u0447\u0438\u0441\u0442\u043A\u0430 \u043A\u044D\u0448\u0430 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0439..."),this.categoriesCache=null,this.cacheTimestamp=0,localStorage.removeItem(this.storageKey),this.loadCategories()}getCacheInfo(){let e=this.categoriesCache?Math.round((Date.now()-this.cacheTimestamp)/1e3):0;return{hasCache:!!this.categoriesCache,ageSeconds:e,itemCount:this.categoriesCache?.length||0}}isLoading(){return this.loadingSubject.getValue()}getError(){return this.errorSubject.getValue()}clearError(){this.errorSubject.next(null)}static \u0275fac=function(t){return new(t||p)(S(f),S(v))};static \u0275prov=w({token:p,factory:p.\u0275fac,providedIn:"root"})};export{v as a,$ as b};
